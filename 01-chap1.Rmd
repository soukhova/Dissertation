
# CHP 1 - A common history between accessibility and spatial interaction

<!-- Required to number equations in HTML files -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

## Overview

This chapter includes text from the first half of the _"Family of accessibility measures derived from spatial interaction principles"_ submitted to _PLOS ONE_. This portion of the work reviews the historical background of spatial interaction modelling, it's use of proportionality constants--linked to empirical information about the system--to maintain units, and the divergence of accessibility practice from this approach.

More specifically, transportation planning has long prioritized the efficiency of movement, or mobility. However, the concept of accessibility represents a more comprehensive evolution, shifting focus from mere movement to the potential to reach (i.e., spatially interact) with desired destinations. Despite growing recognition of accessibility-based planning approaches, the concept remains fragmented, with inconsistent definitions and unclear interpretations. In this chapter: the history of spatial interaction modeling is reviewed, with a focus on the concept of accessibility. It will be demonstrated that widely used mobility and accessibility models, such as gravity-based accessibility and spatial interaction models, share common theoretical roots. From this foundation, we define a family of accessibility measures within the principles of spatial interaction. In demonstrating these developments, three contributions emerge: A) the definition and linkages between four members of the family: specifically, the 'unconstrained' measure (i.e., Hansen-type measure), the 'total constrained' measure  (i.e., a constrained version of the Hansen-type measure), the 'singly constrained' measure (i.e., related to the popular two step floating catchment approach (2SFCA)), and the 'doubly constrained' measure representing realized interactions or 'access', effectively equal to the doubly constrained spatial interaction model in formulation. B) How to formulaically specify the total-, singly- and doubly- constrained accessibility measures. C) The interpretability advantages of the family, as these constrained accessibility measures yield values in units of the number of potential "opportunities for spatial interaction" or "population for spatial interaction" for each zone and zonal flow. By clarifying the concept of 'potential' in accessibility, demonstrating theoretical and formulaic linkages across popular accessibility and spatial interaction models, and reintroducing units, this work contributes a 


## Introduction

In the early nineteenth century, industrializing cities grew rapidly: so did traffic congestion and the development of transportation planning practice focused primarily on mobility. In this newly founded practice, access to destinations was treated as a by-product of movement. Following the rise of the automobile and significant investments in transportation infrastructure after World War II, this mobility-oriented approach has led to some problematic outcomes. Specifically, the car became seen as the ultimate mobility tool, helping to foster the development of low-density, single-use residential neighborhoods and entrenching an automobility mono-culture within transportation systems [@miller_collaborative_2011; @lavery_driving_2013]. Decades of planning for this automobility mono-culture, still often characterized by road and highway expansion, have been marked by increased travel costs and environmental burdens, with limited impact on enhancing the ease with which people can reach destinations [@farber_running_2011; @handyACCESSIBILITYVSMOBILITYENHANCING2002; @paez_healthcare_2010]. In response, transportation researchers have increasingly advocated for the adoption of accessibility as a planning criterion, in contrast to traditional mobility-oriented transportation planning approaches which translate into indicators that benchmark movement (e.g., vehicle kilometres traveled, intersection through traffic, etc.) which are not necessarily linked to improved accessibility [@silvaAccessibilityInstrumentsPlanning2017; @paez_developing_2013; @handy2020; @elgeneidyMakingAccessibilityWork2022]. 

Accessibility may be defined as the "potential of opportunities for [spatial] interaction" [@hansen1959], in contrast to mobility which is simply, movement in itself or 'spatial interaction'. Mobility has been the basis of traditional transportation planning approaches [@ortuzar_2011_modelling]. While accessibility brings a more holistic understanding of combined transportation and land use systems, incorporating both the explicit consideration of destination as opportunity and the concept of _potential_ [@handyMeasuringAccessibilityExploration1997].

The growing interest in accessibility has been accompanied by a boom in scholarly research using different methods and focusing on different research contexts; it has grown to include studies of access to employment [e.g., @karstEvaluationAccessibilityImpacts2003; @grengs2010job; @paez_jobs_2013; @merlin2017competition; @tao_investigating_2020], health care [e.g., @luo2003; @paez_healthcare_2010; @wan2012three; @delamater2013spatial; @boisjoly2017informality; @pereira_2021_geographic], green spaces [@reyesAccessibility2014; @rojas_accessibility_2016; @liang_novel_2024], schools [e.g., @williams_disparities_2014; @romanillosAccessibilitySchoolsSpatial2018; @marques_accessibility_2021], social contacts [e.g., @neutens_human_2007; @farberActivitySpacesMeasurement2012; @farber_2013_social], and regional economic analysis [e.g., @vickermanAccessibility1999; @lopezMeasuring2008; @ribeiro_road_2010; @gutierrez_evaluating_2011] among many other domains of application. In other words, accessibility analysis is used today to broadly understand the potential to reach (or spatially interact with) opportunities that are important to people [@ferreiraReenactingMobilityAccessibility2020]. However, despite its growth in popularity in scholarly works, challenges remain with respect to the more widespread adoption of accessibility in planning practice. For instance, the diversity of accessibility definitions has been flagged by @vanweeAccessible2016, @handy2020, and @kapatsila_resolving_2023. Further, difficulties in the interpretability and communicability of outputs has also been noticed by many authores, including @geursAccessibilityEvaluationLanduse2004, @vanweeAccessible2016, and @ferreiraReenactingMobilityAccessibility2020. 

The adoption of accessibility in planning practice is not necessarily made easier when potential adopters have to contend with a plethora of definitions, each seemingly more sophisticated but less intuitive than the last [@kapatsila_resolving_2023]. At a high level, @geursAccessibilityEvaluationLanduse2004 identify four families of accessibility measures: infrastructure-, place-, person-, and utility-based. Of the place-based family, which is the focus of this paper, the menu has grown to include gravity-based accessibility [e.g., @hansen1959; @pirie_measuring_1979], cumulative opportunities [e.g., @wachs_physical_1973; @pirie_measuring_1979; @ye_spatial_2018], modified gravity [e.g., @SchuurmanMeasuring2010], 2-Step Floating Catchment Areas [e.g., @luo2003], Enhanced 2-Step Floating Catchment Areas [e.g., @luoEnhanced2009], 3-Stage Floating Catchment Areas [e.g., @wan2012three], Modified 2-Step Floating Catchment Areas [e.g., @delamater2013spatial], inverse 2-Step Floating Catchment Areas [e.g., @wang_2sfca_2021], and n-steps Floating Catchment Areas [@liang_novel_2024]. How is a practitioner to choose among this myriad options? What differences in accessibility scores should matter, and how should they be communicated? [see @vanweeAccessible2016; p. 14].

Here, we seek to address the breath of place-based accessibility's definitions and lack of interpretability by demonstrating that mobility-oriented models--such as the commonly used gravity-based accessibility [e.g., @hansen1959] and the spatial interaction model [e.g., @wilson1971]-- are rooted in the same spatial interaction modeling foundation. In fact, we propose that accessibility can be specified using spatial interaction principles as a _family of measures_, akin to the family of spatial interaction models introduced in @wilson1971 that can be defined using balancing factors that constrains values based on known information about the land-use.

This work aims to offer three contributions: (1) it introduces a family of accessibility measures within the principles of spatial interaction; (2) it formally defines three _constrained_ accessibility measures by reintroducing Wilson-analogous balancing factors. These measures are the total constrained accessibility measure, the singly constrained accessibility measure, and the doubly constrained measure, which are explicitly connected to popular measures such as the Hansen-type accessibility [@hansen1959], the popular competition approach of the 2-Step Floating Catchment Area (2SFCA) [@shenLocationCharacteristicsInnercity1998; @luo2003], and the concept of market potential [@harris_market_1954; @vickermanAccessibilityAttractionPotential1974]. These Wilson-analogous balancing factors introduced are also defined in order of increasing restrictiveness to shed light on the role of _potential_ in accessibility and access. (3) This work also demonstrates that the introduction of balancing factors makes accessibility measures easier to interpret and to communicate by restoring the measurement units to the resulting raw accessibility values. Each zonal and zonal flow value from a constrained accessibility measure is always in interpretable units, namely the number of 'opportunities for spatial interaction' or 'population for spatial interaction'. This is in contrast to conventional accessibility measures, particularly gravity based measures, that yield values in units of 'opportunities weighted by some representation of travel friction'.

<!--Motivated by the challenge of incorporating competition into a unified framework for accessibility -->To achieve these stated objectives, this paper contends that accessibility research must reconnect with its spatial interaction origins. Particularly, we argue that an important aspect of spatial interaction modelling--namely, constraining the results to match empirical observations--was never effectively reincorporated into accessibility analysis. Empirical constraints were embraced by early spatial interaction literature following the work of @wilson1971, but this stream of literature tended to flow separately from research inspired by @hansen1959' accessibility. The application of @wilson1971's empirical constraints supported the development of various spatial interaction models that remain relevant in research and practice today [@ortuzar_2011_modelling]. However, the same cannot be said of the contemporary accessibility literature, where empirical constraints were not explicitly adopted. We argue that the absence of empirical constraints (and their attendant proportionality constants) has contributed to some of accessibility analysis' interpretability issues; for instance, the fuzziness of insights beyond simple proportional statements like 'higher-than' or 'lower-than' [@millerAccessibilityMeasurementApplication2018]. Moreover, without constraints we lose track of what accessibility measures, that is, the number of opportunities that can be spatially interacted with. Without a clear sense of measurement units, comparability between accessibility measures, across cities, and transport modes, may also become compromised.

Fortunately, accessibility and spatial interaction modelling literature share common headwaters, and the latter has given careful attention to measurement units and their interpretability. It is by looking to the past that we believe accessibility analysis can newly wade into the future. We continue this work in the following section by tracing the development of accessibility from its origins in spatial interaction: from the Newtonian gravitational expression in @ravensteinLawsMigration1889 through to the seminal accessibility work of @hansen1959. We then present evidence for a narrative highlighting the marked divergence between accessibility and spatial interaction modelling research after the work of @wilson1971. Next, we hark back to @wilson1971's spatial interaction models, and use them to derive a family of accessibility measures based on analogous constraints. We illustrate members of this family of constrained accessibility measures with a simple numerical example. We then conclude by discussing the uses of these measure and their interpretation.

## Newtonian's roots of human spatial interaction research

<!--SUMMARY: Overview of the proportionality constant in Newton Law of Universal Gravitation - it takes the proportion relationship into one of equality. -->
The patterns of people's movement in space have been a subject of scientific inquiry for at least a century and a half. From as far back as Henry C. Carey's *Principles of Social Science* [@careyPrinciplesSocialScience1858], a concern with the scientific study of human spatial interaction can be observed. It was in this work where Carey stated that "man \[is\] the molecule of society \[and their interaction is subject to\] the direct ratio of the mass and the inverse one of distance" [@mckeanManual1883, pp. 37-38]. This statement shows how investigations into human spatial interaction have often been explicitly coloured by the features of Newton's Law of Universal Gravitation, first posited in 1687's *Principia Mathematica* and expressed as in @eq-phys-grav-prop.

$$
F_{ij} \propto \frac{M_i M_j} {D_{ij}^{2}}
$$ {#eq-phys-grav-prop}

To be certain, the expression above is one of proportionality, and is also the most famous in all of science. It states that the force of attraction $F$ between a pair of bodies $i$ and $j$ is directly *proportional* to the product of their masses $M_i$ and $M_j$, and inversely *proportional* to the square of the distance between them $D_{ij}$. Direct proportionality means that as the product of the masses increases, so does the force. Likewise, inverse proportionality means that as the distance increases, the force decreases. @eq-phys-grav-prop, however, does not quantify the magnitude of the force. To do so, an empirical constant, a.k.a. the gravitational constant, is required to convert the proportionality into an equality, ensuring that values of the force $F$ in @eq-phys-grav-prop match the observed force of attraction between masses. In other words, @eq-phys-grav-prop needs to be *constrained* using empirical data. Ultimately, the equation for the force is as seen in @eq-phys-grav, where $G$ is an empirically calibrated proportionality constant:

$$
F_{ij} = G \frac{M_i M_j} {D_{ij}^{2}}
$$ {#eq-phys-grav}

Newton's initial estimate of $G$ was based on a speculation that the mean density of earth was between five or six times that of water, an assumption that received support after Hutton's experiments of 1778 [@hutton_xxxiii_1778, p. 783]. Still, it took over a century from the publication of *Principia* to refine the estimate of the proportionality constant to within 1% accuracy, with Cavendish's 1798 experiment [@cavendish_xxi_1798].

## Early research on human spatial interaction: from Ravenstein (1889) to Stewart (1948)
<!-- 
SUMMARY: a review of spatial interaction literature from the 1880s to the 1940s. A number of researchers theoretically and empirically attempted to characterise human spatial interaction as some force of attraction $F$ that is directly proportion to the masses $Mi$ and $Mj$ and inversely proportional by their separation distance. This concept was captured with different expressions, but all tie back to the same Newtonian gravity analogy, although not all of them included a proportionality constant in their formulation.
-->
Since the 1880s to the 1940s, a number of researchers theoretically and empirically attempted to characterise human spatial interaction as some force of attraction $F$ that is directly proportion to the masses $M_i$ and $M_j$ and inversely proportional by their separation distance. This concept was captured with different expressions, but all tie back to the same Newtonian gravity analogy, although not all of them included a proportionality constant in their formulation.

Following Carey's *Principles* of 1858, research into human spatial interaction continued in different contexts. In the late 1880s, Ravenstein proposed some "Laws of Migration" based on his empirical analysis of migration flows in various countries [@ravensteinLawsMigration1885; @ravensteinLawsMigration1889]. In these works, Ravenstein posited 1) a directly proportional relationship between migration flows and the size of destinations (i.e., centres of commerce and industry), and 2) an inversely proportional relationship between the size of flows and the separation between origins and destinations. As with Carey, these propositions echo Newton's gravitational laws. Over time, other researchers discovered similar relationships. <!--Rilley does not cite Newton, nor Carey, nor Ravenstein.--> For example, @reilly1929methods formulated a law of retail gravitation, expressed in terms of equal attraction to competing retail destinations that could be understood as 'potential trade territories'. Later, Zipf proposed a $\frac{P_1P_2}{D}$ hypothesis for the case of information [@zipfDeterminantsCirculationInformation1946], intercity personal movement [@zipfHypothesisIntercityMovement1946], and goods movement by railways [@zipfHypothesisCaseRailway1946]. The $\frac{P_1P_2}{D}$ hypothesis stated that the magnitude of flows was proportional to the product of the populations of settlements, and inversely proportional to the distance between them.

A common feature of these early investigations of human spatial interaction is that a proportionality constant similar to $G$ in @eq-phys-grav was never considered. Of the researchers cited above, only Reilly and Zipf expressed their hypotheses in mathematical terms. Reilly's hypothesis was presented in the following form:

$$
B_a = \frac{(P_a\cdot P_T)^N}{D_{aT}^n}
$$ {#eq-reilly}

\noindent where $B_a$ is the amount of business drawn to $a$ from $T$, $P_a$ and $P_T$ are the populations of the two settlements, and $D_{aT}$ is the distance between them. Quantity $N$ was chosen by Reilly in a somewhat *ad hoc* fashion as 1, and he used empirical observations of shoppers to choose a value of $n = 2$.

Zipf, on the other hand, wrote his hypothesis in mathematical form as:

$$
C^2 = \frac{P_1\cdot P_2}{D_{12}}
$$ {#eq-zipf}

\noindent where $C$ is the volume of goods exchanged between $1$ and $2$, $P_1$ and $P_2$ are the populations of the two settlements, and $D_{12}$ is the distance between them.

After Carey, it is in Stewart's work on the principles of demographic gravitation that we find the strongest connection yet to Newton's law [@stewartDemographicGravitationEvidence1948]. This may relate to academic backgrounds; where Stewart was a physicist while Ravenstein, Reilly, and Zipf were social scientists. Besides awareness of preceding research (he cites both Reilly and Zipf as predecessors in the analysis of human spatial interaction), Stewart appears to have been the first author to express his theorized relationships for human spatial interaction with a proportionality constant $G$, as follows:

$$
F = G\frac{(\mu_1N_1)(\mu_2N_2)}{d_{12}^2} = G\frac{M_1\cdot M_2}{d_{12}^2} 
$$ {#eq-stewart-force}

\noindent Where:

-   $F$ is the *demographic force*
-   $N_1$ and $N_2$ are the numbers of people of in groups 1 and 2
-   $\mu_1$ and $\mu_2$ are so-called *molecular weights*, the attractive weight of groups 1 and 2
-   $M_1 = \mu_1N_1$ and $M_2 = \mu_2N_2$ are the demographic masses at 1 and 2
-   $d_{12}^2$ is the distance between $1$ and $2$
-   And finally $G$, a constant that Stewart "left for future determination" [-@stewartDemographicGravitationEvidence1948, p. 34]

In addition to demographic force, Stewart defined a measure of the "population potential" of group $2$ with respect to group $1$. In other words, the potential number of people from location $2$ that could visit location $1$, as follows:

$$
V_1 = G\frac{M_2}{d_{12}}
$$ {#eq-stewart-population-potential}

For a system with more than two population bodies, Stewart formulated the population potential at $i$ as follows (after arbitrarily assuming that $G=1$): 

$$
V_i = \int\frac{D}{r} ds
$$ {#eq-stewart-population-potential-integral}

\noindent where $D$ is the population density over an infinitesimal area $ds$ and $r$ is the distance to $i$. In @eq-stewart-population-potential-integral, $D\cdot ds$ gives an infinitesimal count of the population, say $dm$, and so, after discretizing space, @eq-stewart-population-potential-integral can be rewritten as: 

$$
V_i = \sum_j M_jd_{ij}^{-1}
$$ {#eq-stewart-population-potential-sum}

Alerted readers will notice that @eq-stewart-population-potential-sum, with some re-organization of terms, is formally equivalent to our modern definition of accessibility popularized by @hansen1959 in the late 1950s.

Stewart's formulation of demographic force, developed in the context of what he called "social physics" [@stewartPrinciples1947], was problematic. It had issues with inconsistent mathematical notation. <!--For example, in @stewartDemographicGravitationEvidence1948, $G$ is used as a proportionality constant p. 34 and then later as _demographic energy_ on p. 53.--> More seriously though, Stewart's work was permeated by a view of humans as particles following physical laws, but tinted by unscientific and racist ideas. For instance, he assumed that the molecular weight $\mu$ of the average American was one, but "presumably...much less than one....for an Australian aborigine" \[p. 35\]. Stewart's ideas about "social physics" soon fell out of favour among social scientists, but not before influencing the nascent field of accessibility research, as detailed next.

## Hansen's gravity-based accessibility to today {#grav-to-today}

<!-- SUMMARY: Stewart 1948 made an important contribution methodologically: Hansen picked it up and is now cited as the father of accessibility. However, Hansen work was applied, and he's use of Stewart's Population Potential measure included two crucial omissions that afflict the literature to this day. The first omission is 1) Stewart set the proportional constant $G$ to 1 _for future determination_, this constant is not explicitly addressed in @hansen1959 and accessibility continues to evolve without it. The second omission is 2) Stewart suggests that keeping the exponent value of $d_ij$ as 1 is sufficient. In @hansen1959, an exponent other than 1 for $d_ij$ is selected based on empirical findings, however, the issue of _opportunity potential_ units are never addressed. -->

From @stewartDemographicGravitationEvidence1948, we arrive to 1959 and Walter G. Hansen, whose work proved to be exceptionally influential in the accessibility literature [@hansen1959]. In this seminal paper, Hansen defined accessibility as "the potential of opportunities for interaction... a generalization of the population-over-distance relationship or *population potential* concept developed by @stewartDemographicGravitationEvidence1948" (p. 73). As well as being a student of city and regional planning at the Massachusetts Institute of Technology, Hansen was also an engineer with the Bureau of Roads, and preoccupied with the power of transportation to shape land uses in a very practical sense. @hansen1959 focused on @stewartDemographicGravitationEvidence1948's *population potential* (expressed in @eq-stewart-population-potential-sum), and not on the other formulaic contributions and objectionable aspects of "social physics". @hansen1959 recast Stewart's population potential to reflect accessibility, a model of human behaviour useful to capture regularities in mobility patterns. @hansen1959 replaced $M_j$ in @eq-stewart-population-potential-sum with *opportunities* to derive an *opportunity potential*, or more accurately, a *potential of opportunities for interaction* as follows:

$$
S_{i} = \sum_j \frac{O_j }{d_{ij}^\beta}
$$ {#eq-accessibility}

A contemporary rewriting of @eq-accessibility accounts for a variety of impedance functions beyond the inverse power $d^{-\beta}$:

$$
S_{i} = \sum_j O_j \cdot f(d_{ij})
$$ {#eq-accessibility-general}

$S_{i}$ in @eq-accessibility is a measure of the accessibility from site $i$. This is a function of $O_j$ (the mass of opportunities at $j$), $d_{ij}$ (the cost, e.g., distance or travel time, incurred to reach $j$ from $i$), and $\beta$ (a parameter that modulates the friction of cost). Today, Hansen is frequently cited as the father of modern accessibility analysis [e.g., @reggianiGuestEditorialNew2011], and Hansen-type accessibility is commonly referred to as the gravity-based accessibility measure.

However, Hansen's use of Stewart's *population potential* measure included one crucial omission that afflicts the literature to this day. The omission is that between @stewartDemographicGravitationEvidence1948 and @hansen1959, the proportionality constant $G$ in @eq-stewart-population-potential vanished. This constant was not explicitly addressed in @hansen1959 and accessibility research continues to evolve without it. Since @hansen1959, accessibility analysis has been widely used in numerous disciplines but, to our knowledge, the proportionality constant has remained forgotten, with no notable developments to explicitly acknowledge or determine it. 

The omission of this constant generates a fundamental problem for the measurement unit of accessibility estimates, which undermines the interpretation, communication and comparability of accessibility analysis. Those reading @hansen1959 must recall that @stewartDemographicGravitationEvidence1948 had set the proportionality constant $G$ to 1, with a note that "$G$ \[was\] left for future determination: a suitable choice of other units can reduce it to unity" [p. 34]. In practice, the persistent omission of the constant in accessibility analyses means that $G$ continues to be implicitly set to $1$, even when the fundamental relationship in accessibility is proportionality (e.g., $S_{i} \propto \sum_j g(O_j)f(d_{ij})$) and not equality [for instance, see the formula for accessibility at the top of Figure 1 in @wuUnifyingAccess2020]. The direct consequence is that without a proportionality constant, the units of $S_i$ remain unclear: the unit of "potential of opportunity for interaction" is left free to change as $\beta$ is calibrated. For example, if $c_{ij}$ is distance in meters, it will be number of opportunities per $m^{\beta}$ when $f(c_{ij}) = d^{-\beta}$ but number of opportunities per $e^{-\beta\cdot m}$ when $f(c_{ij}) = e^{-\beta\cdot m}$. This undermines the comparability of accessibility metrics with different decay functions, and renders their results difficult to understand and communicate. The Hansen-style accessibility estimates found in the literature, therefore, are better thought of as ordinal measures of potential that can only be interpreted in terms of higher and lower accessibility, but which has not palpable meaning [@millerAccessibilityMeasurementApplication2018].

## Wilson's family of spatial interaction models

<!--SUMMARY: Introduce Wilson's spatial interaction model. Then discuss how it could relate to gravity analogy -- but is tactically derived using entropy-maximisation, obtaining the interaction variable as a statistical average. Then introduce the constraints and cases. -->

On the other side of the Atlantic, Alan G. Wilson was developing related, yet parallel work. In his groundbreaking study [@wilson1971], Wilson defined a general spatial interaction model as follows. While accessibility was characterised as an associated concept of 'potential', the primary focus was on modelling observed spatial interaction:
$$
T_{ij} = k W_i^{(1)} W_j^{(2)} f(c_{ij})
$$ {#eq-phys-gravity-model}

The model in @eq-phys-gravity-model posits a quantity $T_{ij}$ that represents a value in a matrix of flows of size $n \times m$, that is, between $i = 1,\cdots, n$ origins and $j = 1,\cdots, m$ destinations. The quantities $W_i^{(1)}$ and $W_j^{(2)}$ are proxies for the masses at $i=1,\cdots,n$ origins and $j=1,\cdots,m$ destinations. The super-indices $(1)$ and $(2)$ are meant to indicate that these masses could be different things, i.e., $W_i^{(1)}$ could be populations, and $W_j^{(2)}$ hectares of park space. Finally, $f(c_{ij})$ is some function of travel cost $c_{ij}$ which reflects travel impedance. In this way, $T_{ij}$ explicitly measures *interaction* in the unit of trips, and the role of $k$ is to ensure that the system-wide sum of $T_{ij}$ represents the total flows in the data. In other words, $k$ is a scale parameter that makes the overall amount of flows identical to the magnitude of the phenomenon being modeled. In other words, it balances the units, in a conceptually similar sense as the gravitational constant in Newtonâ€™s Law of Universal Gravitation.

Traditionally, the development of the spatial interaction model put an emphasis on the interpretability of the results [@kirbyNormalizingFactorsGravity1970; @wilsonSTATISTICALTHEORYSPATIAL1967; @wilson1971]. But instead of relying on the heuristic of Newtonian gravity (e.g., some interaction between a mass at $i$ and a mass at $j$ separated by some distance), Wilson's approach was to maximise the entropy of the system. Entropy maximisation in this case achieves stable results as a statistical average that represents the population. The approach works by assuming undifferentiated individual interactions, and assessing their probabilities of making a particular journey. The result of @eq-phys-gravity-model then is a statistical average [@wilson1971; @seniorGravityModellingEntropy1979].

To ensure that $T_{ij}$ in @eq-phys-gravity-model is in the unit of trips (our unit of origin-destination spatial interaction), additional knowledge about the system is required. At the very least, this framework assumes that the total number of trips in the system $T$ is known, and therefore:

$$
\sum_i\sum_j T_{ij} = T
$$ {#eq-constraint0-gravitymodel}

Additional information can be introduced. For example, when information is available about the total number of trips produced by each origin, $W_i^{(1)}$ is represented as $O_i$ and the following constraint can be used:

$$
\sum_j T_{ij} = O_i
$$ {#eq-constraint1-gravitymodel}

Alternatively, if there is information available about the total number of trips attracted by each destination, $W_j^{(2)}$ is represented as $D_j$ and the following constraint can be used: 

$$
\sum_i T_{ij} = D_j
$$ {#eq-constraint2-gravitymodel}

It is also possible to have information about both $O_i$ and $D_j$, in which case both constraints could be imposed on the model at once.

Using information about the system that satisfy these constraints fully, partially or not at all, a family of spatial interaction models can be derived based on @eq-phys-gravity-model. $K$ is specified depending on the applied constraint(s). In the framework introduced in @wilson1971, three constrained versions are specified: the first being a case where to results only match the total volume of interaction, the second being a singly constrained case, and the third a doubly constrained case.

In the first, @eq-constraint1-gravitymodel and @eq-constraint2-gravitymodel do not hold. In practical terms, this means that the total number of trips predicted by the model must be equal to sum of all flows from origins i to destinations j. The balancing constant $K$ in this case is [see @cliff_evaluating_1974; @fotheringham_spatial_1984]:

$$
K=\frac{T}{\sum_i\sum_j T_{ij}}
$$ {#eq-total-flow-balancing-factor}

In the second case, only one of @eq-constraint1-gravitymodel or @eq-constraint2-gravitymodel hold. The resulting models are, in Wilson's terms, singly constrained. When only @eq-constraint1-gravitymodel holds, entropy maximisation leads to the following production-constrained model:

$$
T_{ij} = A_i O_i W_j^{(2)} f(c_{ij})
$$ {#eq-production-constrained-gravitymodel}

Notice how, in this model, the proxy for the mass at the origin $W_i^{(1)}$ is replaced with $O_i$, representing what we know about the system, the spatial interaction outbound flow, i.e., outbound trips produced at $i$. Also, there is no longer a single system-wide proportionality constant, but rather a set of proportionality constants (i.e., balancing factors) specific to origins. For this model, the balancing factors ensure that @eq-constraint1-gravitymodel is satisfied, meaning that the sum of predicted flows from one origin going to all destinations must equal the known mass at that origin $O_i$ i.e., the total number of outbound trips. Satisfying this constraint also implicitly fulfills the total constraint (@eq-constraint0-gravitymodel), since the sum of $O_i$ values across all origins equals the total number of trips. This model is useful when trips ends are unknown but the number of trips originating from each location is known and the total of these trips represents all trips in the system. The balancing factors for the production-constrained model are solved for each origin $A_i$, and according to Wilson are:

$$
A_i = \frac{1}{\sum_j W_j^{(2)} f(c_{ij})}
$$ {#eq-production-constrained-balancing-factor}

The attraction-constrained model is similar to the production-constrained model as it is also singly constrained but from the perspective of the mass at the destination. From the attraction-constrained model, the proxy for the mass at the destination $W_j^{(2)}$ is now replaced with $D_j$, representing the spatial interaction inbound flow, i.e., trips attracted at the destination and takes the following form:

$$
T_{ij} = B_j D_j W_i^{(1)} f(c_{ij})
$$ {#eq-attraction-constrained-gravitymodel}

In this model (@eq-attraction-constrained-gravitymodel), the balancing factors ensure that @eq-constraint2-gravitymodel is satisfied (hence the total constraint @eq-constraint0-gravitymodel is as well), meaning that the sum of predicted flows going to one destination from all origins must equal the known mass of that destination $D_j$ i.e., the total number of inbound trips to $j$. This should hold for all destinations. As before, destination-specific proportionality constants (i.e., balancing factors) $B_j$ were derived by Wilson as:

$$
B_j = \frac{1}{\sum_i W_i^{(1)} f(c_{ij})}
$$ {#eq-attraction-constrained-balancing-factor}

The third case in the family of spatial interaction models is the production-attraction constrained model. In this case, both @eq-constraint1-gravitymodel and @eq-constraint2-gravitymodel hold simultaneously. These constraints ensure that the sum of predicted flows from one origin to all destination, and the predicted flows going to one destination from all origins must equal the known mass of the origin $O_i$ and of the destination $D_j$. This should hold for all origins and destinations. The resulting model is, in Wilson's terms, doubly constrained, and takes the following form:

$$
T_{ij} = A_i B_j O_i D_j f(c_{ij})
$$ {#eq-doubly-constrained-gravitymodel}

In this model, both proxies for the masses are replaced with the known masses, that is, the trips produced by the origin and the trips attracted by the destination. There are now two sets of mutually dependent proportionality constants:

$$
\begin{array}{l}
A_i = \frac{1}{\sum_j B_j D_j f(c_{ij})}\\
B_j = \frac{1}{\sum_i A_i O_i f(c_{ij})}
\end{array}
$$ {#eq-doubly-constrained-balancing-factors}

Derivation of these models is demonstrated in detail elsewhere [e.g., @ortuzar_2011_modelling; @wilsonSTATISTICALTHEORYSPATIAL1967]. It is worth noting, however, that although Wilson's approach is built on a different conceptual foundation than the old reference to Newtonian gravity, the work succeeded at identifying the steps from proportionality to equality to yield variations of proportionality constants, including the one that eluded @stewartDemographicGravitationEvidence1948 and that has been overlooked in almost all subsequent accessibility research. Why was this key element of spatial interaction models potentially ignored in accessibility research? In the next section we aim to address this question.

## Accessibility and spatial interaction modelling: two divergent research streams

<!--
SUMMARY: Accessibility developed separate from SIM.

SIM focuses on trips and was institutionalized to develop the US Interstate highway systems. Many guidelines and practical training was done - a lot of funding. SIM development has integrated accessibility in a few ways: 1) within the SIM itself as a balancing factor, 2) as an additional independent variable in the SIM, 3) SIM and HAM in parallel in the context of location allocation problems and within the steps of transportation demand modelling (trip distribution or trip generation). 

Accessibility research has separated SIM almost entirely. When Wilson is cited: 1) typically when using a different impedance function, 2) when using the SIM to predict trip flows for accessibility input or vice versa, 3) a few exceptional papers that interpret the doubly-constraints as an inverse HAM in the context of competitive accessibility, and 4) it was only until recently, that a singly-constrain was introduced in Soukhov et al. 2023. -->

```{r}
#| label: load-data

load(glue::glue(here::here(),
                "/data/corpus.rda"))
```

```{r}
#| label: calculate-cocMatrix
#| cache: true

# $A$ is a sparse adjacency matrix with sources cited by each document in the corpus
A <- cocMatrix(corpus, 
               Field = "CR", 
               sep = ";")
```

```{r}
#| label: coupling-matrix

# The product of $A$ and its transpose gives the bibliographical coupling by cited references $B = A\cdot A^T$

# $B$ is a square symmetric matrix where element $b_{ij}$ is the total number of cited references in common between document $i$ and document $j$. A higher value of $b_{ij}$ indicates a stronger relationship between documents $i$ and $j$ (more references in common). A value of zero indicates no references in common.
B <- tcrossprod(A)
```

```{r}
#| label: clean-coupling-matrix

# Remove the diagonal (papers cited within a single source)
B_nd <- B - Matrix::band(B, 0, 0)
```

```{r}
#| label: create-coupling-network

#These matrices are sparse symmetric matrices of "adjacencies" between documents in the corpus. Convert `B` to an `igraph` network without the diagonal
coupling_net <- igraph::graph_from_adjacency_matrix(B, 
                                            mode = "directed", 
                                            weighted = TRUE,
                                            diag = FALSE)
```

```{r}
#| label: remove-A-memory

rm(A)
```

```{r}
#| label: convert-to-tidygraph

# For convenience, convert the [{igraph}](https://r.igraph.org) object to a [{tidygraph}](https://www.data-imaginist.com/posts/2017-07-07-introducing-tidygraph/) object:
coupling_net <- tidygraph::as_tbl_graph(coupling_net)
```

```{r}
#| label: add-corpus-label-to-coupling-network

# Add the `corpus` variable to `coupling_net`. Remember to activate the nodes.
coupling_net <- coupling_net |>
  tidygraph::activate("nodes") |>
  left_join(tibble::rownames_to_column(corpus, 
                                       var = "rowname") |> 
              transmute(rowname, 
                        corpus = corpus),
            by = c("name" = "rowname"))
```

```{r}
#| label: corpus-summary

summary_coupling_network <- coupling_net |>
  tidygraph::activate("nodes") |>
  as_tibble() |>
  mutate(corpus = factor(corpus)) |>
  group_by(corpus) |>
  summarize(n = n())

# Number of documents in each corpus
# Hansen
n_h <- summary_coupling_network |> 
  filter(corpus == "Hansen") |> 
  pull(n)
# Wilson
n_w <- summary_coupling_network |> 
  filter(corpus == "Wilson") |> 
  pull(n)
# Both
n_b <- summary_coupling_network |> 
  filter(corpus == "Both") |> 
  pull(n)
```

The work of @hansen1959 and @wilson1971 responded to important developments, in particular a need "to meet the dictates and needs of public policy for strategic land use and transportation planning" [@battyChronicleScientificPlanning1994]. These dictates and needs were far from trivial. In the United States alone, the Federal-Aid Highway Act of 1956 authorized the creation of the U.S. Interstate Highway System, with a budget that ultimately exceeded one hundred billion dollars (equivalent to over $600 billion in 2023) [@weinerUrbanTransportationPlanning2016; @mdotMnDOTJoins2007]. Spatial interaction modelling was incorporated into institutional modelling practices meant to "predict and provide", i.e., predict travel demand and supply transportation infrastructure [@kovatch1971modeling; @weinerUrbanTransportationPlanning2016]. Accessibility, at the time, did not quite have that power, as it did not quantify trips, but rather something somewhat more elusive: it predicts the less tangible "potential" for spatial interaction with opportunities. In this way, where spatial interaction modelling became a key element of transportation planning practice, accessibility remained a somewhat more academic pursuit, and the two streams of literature only rarely connected.

```{r}
#| label: plot-docs-per-year
#| include: false

docs_per_year_plot <- ggplot(data = corpus |> 
         group_by(corpus, PY) |> 
         summarize(n = n()),
         .groups = "drop") + 
  geom_col(aes(x = PY, 
               y = n,
               fill = corpus),
           color = "black") + 
  xlab("Publication year") + 
  ylab("Number of documents") +
  theme_minimal()

ggsave(filename = glue::glue(here::here(), 
                             "/figures/docs_per_year_plot.png"))
```

```{r}
#| label: fig-docs-per-year
#| out-width: 70%
#| fig-cap: "Historical pattern of publication: documents per year."

docs_per_year_plot
```

To illustrate this point, we conducted a bibliographic analysis of the literature that cites @hansen1959, @wilson1971, or both. We retrieved all relevant documents using the Web of Science "Cited References" functionality, and the digital object identifiers of @hansen1959 and @wilson1971. As a result of this search, we identified `r n_h |> prettyNum(big.mark = ",")` documents that cite @hansen1959, only `r n_w |> prettyNum(big.mark = ",")` documents that cite @wilson1971, and `r n_b |> prettyNum(big.mark = ",")` that cite both. The earliest document in this corpus dates to `r min(corpus$PY)` and the most recent is from `r max(corpus$PY)`. The number of documents per year appears in @fig-docs-per-year, where we see the frequency of documents over a span of almost fifty years. In particular, we notice the remarkable growth in the number of papers that cite @hansen1959 compared to those that cite @wilson1971 since the year 2000.

As noted, literature that cites both @wilson1971 and @hansen1959 are sparse (only `r (n_b / (n_b+n_h+n_w) )|> scales::percent(0.1)` of the corpus, visualised in pink in @fig-docs-per-year). After reading the works, we can also discern that they too are divergent, with one stream focused on developing accessibility (i.e., *potential for* spatial interaction) and another on spatial interaction. The focuses of these divergent streams contribute this paper's broader hypothesis that the concepts of accessibility and spatial interaction have remained largely disconnected, and at times, improperly conflated. 

On one hand, the stream of literature focused on spatial interaction models inspired by @wilson1971 and which cite both @hansen1959 and @wilson1971, tends to contribute to understanding how accessibility is interpreted and incorporated in spatial interaction models. These works treat separate spatial interaction and accessibility as a seperate but related phenomenon. Specifically, some early works interpret the spatial interaction model's balancing factors (@eq-production-constrained-balancing-factor or @eq-doubly-constrained-balancing-factors) as the inverse of @hansen1959's model [@harrisEquilibriumValuesDynamics1978; @leonardiOptimumFacilityLocation1978; @fotheringhamSPATIALSTRUCTUREDISTANCE1981; @fotheringhamSpatialCompetitionAgglomeration1985], recognizing it as a "common sense" approach [@morrisAccessibilityIndicatorsTransport1979, p. 99] to including accessibility in the spatial interaction model, though further exploration of its relationship is warranted [@battyMethodResiduesUrban1976]. Some authors have explored this relationship, for instance as in @fotheringhamSpatialCompetitionAgglomeration1985 who demonstrates how the spatial interaction model may insufficiently explain spatial patterns, and suggests that explicitly defining destinations' accessibility as a variable within the model may remedy the issue (e.g., the *competition destination* model). Other works used both @hansen1959 and @wilson1971's framework in conjunction, such as in defining location-allocation problems in operations research [@leonardiOptimumFacilityLocation1978; @beaumontLocationallocationProblemsPlane1981], estimating trip flows (or some other spatial interaction flows) alongside accessibility [e.g., @clarke2002deriving; @grengs2004measuring; @turk2019socio], or considering accessibility within spatial interaction models, in line with @fotheringhamSpatialCompetitionAgglomeration1985's demonstration [e.g., @beckers2022incorporating]. Other works departed from @hansen1959's definition and aligned with spatial interaction in different ways, such as using micro-economic consumer behaviour concepts to express potential for spatial interaction [@morrisAccessibilityIndicatorsTransport1979; @leonardiRandomUtilityDemand1984].

<!-- rafa 1: no need to keep all references in each citation block. AS: I'll keep them for now. -->

<!-- rafa 2: no need to keep all references in each citation block. AS: I'll keep them for now. -->

On the other hand, there is another subset of literature that cite both @hansen1959 and @wilson1971 that is accessibility-focused. We categorise their citation of @wilson1971 for three general reasons. Firstly, a group of these works cite @wilson1971 as attribution for using context-dependent travel cost functions [e.g., @weibullNumericalMeasurementAccessibility1980; @handyMeasuringAccessibilityExploration1997; @kwan1998space; @shenLocationCharacteristicsInnercity1998; @ashiru2003space; @rau2012spatial; @pan2013impacts; @margaridacondecomelhoradoImpactMeasuringInternal2016; @caschili2015accessibility; @grengs2015nonwork; @pan2020measuring; @chia2020extending; @roblot2021participation; @sharifiasl2023incorporating; @kharel2024examining]. These works do not necessarily comment on spatial interaction explicitly. Secondly, another group of this accessibility-focused "both" citing literature _does_ associate spatial interaction as defined in @wilson1971 with accessibility's potential for spatial interaction more explicitly [e.g., @millerMeasuringSpaceTimeAccessibility1999; @giuliano2010accessibility; @grengs2010intermetropolitan; @grengs2010job; @grengs2012equity; @levine2012does; @levinson2012positive; @tong2015transportation; @liu2015spatial; @he2017measuring; @wuUnifyingAccess2020; @ng2022reflection; @naqavi2023mobility; @suel2024measuring]. We agree accessibility and spatial interaction are related topics: accessibility is an expression of its *potential* and the @wilson1971 paper briefly touches on the concept. However, in some of this literature, @hansen1959 and @wilson1971 are co-cited as both being 'gravity models' [e.g., @liu2004accessibility; @dai2017visualization; @shen2019segregation; @chia2020extending], perhaps revealing the murkiness of the distinction between spatial interaction and the *potential for* spatial interaction in the literature. Thirdly, there is a group of accessibility-focused works that interpret @hansen1959's model as the singly- or doubly- constrained spatial interaction model's inverse balancing factor [e.g., @vickermanAccessibilityAttractionPotential1974]. This group cities the earlier spatial interaction works that make this connection and is especially prominent in the investigation of competitive accessibility topics [e.g., @karstEvaluationAccessibilityImpacts2003; @geurs2006accessibility; @willigers2007accessibility; @el2011place; @curtis2010planning; @manaugh2012makes; @chen2013regional; @alonso2014labour; @albacete2017measuring; @sahebgharani2019computing; @mayaud2019future; @allenMeasureCompetitiveAccess2020; @levinsonGeneralTheoryAccess2020; @marwal2022literature; @su2023untangling]. As outlined in preceding sections, we argue interpreting the singly- or doubly- constrained spatial interaction model's balancing factor as accessibility yields output values that are similarly plagued by interpretability issues. 

Lastly, as an extension of the third reason within this group, only the works of @soukhovIntroducingSpatialAvailability2023 and @soukhovMultimodalSpatialAvailability2024 use @wilson1971's balancing factors as a method for maintaining constraints on opportunities within the context of competitive accessibility. These works introduce the balancing factors as a mechanisms to ensure that opportunities at each destination are proportionally allocated to each zone (based on the proportion of population seeking opportunities and the relative travel impedance). This is to ensure that each zonal accessibility value is the sum of this proportional allocation from each destination, and that all zonal values ultimately sum to the total number of opportunities in the region. However, these balancing factors were deduced intuitively. These works do not explicitly state that the mathematical formulation of the equations are effectively equivalent to Wilsonâ€™s singly constrained model (derived from entropy maximization). This equivalence is only discovered in hindsight, as will be demonstrated in this study. These two works also do not discuss other constrained cases that will be addressed in the next section.